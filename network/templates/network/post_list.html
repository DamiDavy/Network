{% extends "network/layout.html" %}
{% load static %}

{% block header %}
<h2>All Posts</h2>
{% endblock %}

{% block addtwit %}
{% if user.is_authenticated %}
<div id="new-post">
    <h5>New Post</h5>
    <form id="compose-form" action="{% url 'compose' %}" method="post">
        {% csrf_token %}
        <textarea name="post" class="form-control area" id="compose-body" rows="2"></textarea>
        <input type="submit" class="btn btn-primary postbtn" value="Post">
    </form>
</div>
{% endif %}
<hr>
{% endblock %}

{% block body %}

{% for post in post_list %}
<div class="post">
    <a class="userlink" href="{% url 'person' post.user.id %}"><strong>{{ post.user.username }}</strong></a>
    <span class="time">{{ post.timestamp }}</span>

    {% if post.user.username == user.username %}
    <button class="editbtn btn btn-outline-primary" id="b{{ post.id }}">Edit</button>
    {% endif %}

    <br>{{ post.content }}<br>

    <span class="likes">
        {% if user.is_authenticated %}
        <i class='far fa-heart like' id="i{{ post.id }}" {% if user in post.likes.all %}style="color:Blue;" {% else
            %}style="color:Red;" {% endif %}></i>
        {% else %}
        <i class='far fa-heart'></i>
        {% endif %}

        <span id="likes{{ post.id }}">
            {% if post.likes.count > 0 %}
            {{ post.likes.count }}
            {% endif %}
        </span>
    </span>
</div>

{% if user.is_authenticated %}
<div class="edit" id="edit{{ post.id }}">
    <form id="compose-form" action="{% url 'edit' post.id user.id %}" method="post">
        {% csrf_token %}
        <textarea name="edit" class="form-control area" id="compose-body" rows="2">{{ post.content }}</textarea><br>
        <input type="submit" class="btn btn-primary" value="Save">
    </form>
</div>
{% endif %}

<hr>{% endfor %}

<script src="{% static 'network/post.js' %}"></script>
{% endblock %}